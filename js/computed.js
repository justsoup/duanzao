!function(){let e=document.querySelector(".mainBox1"),t=document.querySelector(".mainBox2"),u={},n=function(){t.style.display="none",e.style.display="block";let n=document.getElementById("selectBox"),a=document.getElementById("select2Box"),o=(n.getElementsByTagName("options"),document.getElementById("grade")),r=document.getElementById("btn"),m=document.getElementById("result"),d=document.getElementById("imgBox"),s=document.getElementById("data1"),c=document.getElementById("data2"),i=document.getElementById("data3"),b=document.getElementById("data4"),v=document.getElementById("data5"),N=document.getElementById("data6"),g=document.getElementById("data7"),h=document.getElementById("data8"),y=document.getElementById("data9"),p=null,x=null,B=document.querySelector(".hiddenBox"),f={0:1100,1:1200,2:1200,3:1300,4:1700,5:1800,6:1800,7:1900,8:2200,9:2300,10:2300,11:2400};new Promise((e,t)=>{let u=null,n=new XMLHttpRequest;n.open("GET","json/attribute.txt"),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(u=n.responseText,e(u))},n.send(null)}).then(function(e){let t=e.toString();p=t.split(/[a-w]/i)}),r.onclick=function(){let e=o.value,t=n.selectedIndex,u=null,l=f[t],a=null,r=null,c=800;if(u=t<4?250:t<8?350:500,(c=c+100*parseFloat(v.value)+100*parseFloat(N.value)+60*parseFloat(g.value)+50*parseFloat(h.value))<parseFloat(l)){let e=parseFloat(l)-parseFloat(c);return m.innerText="失败了，需要再多加点燃料\n",void(m.innerText+="还缺少"+e+"°")}(a=function(e=0,t=0){return 250*e/t}(c,l))>u&&(a=u),r=Math.floor(e/50+3*a/20+.5*parseFloat(y.value)),x=1.2*r+parseFloat(s.value),x=Math.floor(100*x)/100,m.innerText="初始伤害为 "+x+"(只取整)\n",m.innerText+="锻造结果等级 "+r+"\n",0==n.value&&(console.log(n.value),m.innerText+="资料来源：放置江湖攻略组 \n"),d.style.display="block"};let E=function(){let e=n.value,t=a.value,u=p[t].replace(/^\s*|\s*$/g,"").split("\n")[e].split("\t");s.value=u[2],c.value=u[4],i.value=u[5],b.value=u[3]};n.onchange=E,a.onchange=E,d.onclick=function(){d.style.display="none",B.style.display="block"},B.onclick=function(){u.attack=x,u.hardness=c.value,u.toughness=i.value,u.weight=b.value,u.mold=a.value,l()}},l=function(){e.style.display="none",t.style.display="block";let n=document.getElementById("data00"),l=document.getElementById("data01"),a=document.getElementById("data02"),o=document.getElementById("data03"),r=document.getElementById("data04"),m=document.getElementById("data05"),d=document.getElementById("data06"),s=document.getElementById("show1"),c=document.getElementById("show2"),i=document.getElementById("btn2"),b=t.querySelectorAll("label"),v=document.getElementById("material1"),N=document.getElementById("material2"),g=document.getElementById("material3"),h=document.getElementById("btn3"),y=document.querySelector(".playBtn"),p=document.getElementById("myMusic"),x=document.getElementById("input3"),B=document.getElementById("printBox");0!==Object.keys(u).length&&(n.value=parseInt(u.attack),l.value=u.weight,a.value=u.hardness,o.value=u.toughness);let f=null,E=null,I=null,k=!1,w={},F=1,T=0,S=0,C=!1,q=a.value,M=o.value,j=parseInt(u.mold);new Promise((e,t)=>{let u=null,n=new XMLHttpRequest;n.open("GET","json/recast.txt"),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(u=n.responseText,e(u))},n.send(null)}).then(function(e){let t=e.toString().split(" "),n=parseFloat(u.mold),l=6*(n-1),a=6*n-1;I=t.slice(l,a+1)}).then(function(){let e=["1","0.033","0.4","-0.4","1","1","0.02","-0.4","0.4","1","1.1","0.01","0.15","-0.15","1.2","1.2","0.033","0.38","-0.38","1.1","1.2","0.02","-0.38","0.38","1.3","1.4","0.01","0.35","-0.25","1.45","1.2","0.03","0.05","-0.05","1.6","1.3","0.02","-0.25","0.25","1.7","1.4","0.01","0.03","-0.03","1.85","1.6","0.033","0.25","-0.2","1","1.4","0.02","-0.1","0.25","1.2","1.75","0.01","0.15","-0.05","1.2","1.25","0.01","0.2","-0.12","1.1","1.4","0.015","-0.15","0.25","1.15","1.5","0.01","0.12","-0.08","1.25"],t=["1.1","0.033","0.35","-0.2","1","1.2","0.02","-0.2","0.35","1.1","1.35","0.01","0.15","-0.15","1.25","1","0.025","0.33","-0.3","1","1.1","0.01","-0.25","0.28","1.1","1.2","0.01","0.2","-0.2","1.25","1.2","0.01","0.4","-0.4","1.1","1.3","0.02","-0.15","0.15","1","1.25","0.01","0.1","-0.1","1.2","1.1","0.03","0.2","-0.12","1","1.3","0.02","-0.12","0.2","1","1.15","0.015","0.15","-0.15","1.25","1.2","0.025","0.3","-0.32","1","1.25","0.038","-0.15","0.27","1.1","1.3","0.02","0.25","-0.22","1.25"],u=["1.1","0.03","0.3","-0.2","1","1.2","0.05","-0.2","0.25","1.1","1.25","0.05","0.2","-0.15","1.2","1","0.25","0.28","-0.15","1","1.1","0.05","-0.2","0.2","1.1","1.2","0.03","0.15","-0.15","1.2","1","0.02","0.12","-0.08","1","1.1","0.02","-0.4","0.4","1","1.25","0.01","0.1","-0.1","1.25","0.85","0.05","0.25","-0.2","1","0.9","0.04","-0.2","0.25","1.1","1","0.03","0.15","-0.15","1.35","0.95","0.05","0.22","-0.1","1","1","0.04","-0.2","0.18","1.1","1.15","0.03","0.15","-0.15","1.2"],n=["1","0.01","0.3","-0.3","1","1","0.01","-0.3","0.3","1.1","1.2","0.01","0.2","-0.2","1.25","0.8","0.005","0.15","-0.1","1.2","0.8","0.004","-0.1","0.25","1.25","1","0.002","0.1","-0.1","1.4","1","0.15","0.25","-0.2","1","0.9","0.1","-0.2","0.25","1.1","1.1","0.1","0.15","-0.15","1.25","0.75","0.03","0.15","-0.15","1.2","0.9","0.02","-0.15","0.15","1.3","1","0.01","0.1","-0.1","1.4","1.1","0.05","0.25","-0.1","1","0.98","0.08","-0.2","0.25","1.1","1.2","0.1","0.15","-0.05","1.2"],l=["1.15","0.04","0.2","-0.05","1.1","1.15","0.04","-0.12","0.2","1.1","0.9","0.03","0.14","0.1","0.85","1.2","0.05","0.2","-0.05","1.1","1.25","0.05","-0.12","0.2","1.1","1.1","0.04","0.14","0.1","1","1.6","0.04","0.23","-0.12","1","1.6","0.04","-0.12","0.23","1","1.4","0.03","0.18","0.18","1.1"],a=j;j=parseFloat(j)%5;let o=Math.floor(a/5.1),r=null,m=null;switch(r=0===j?60:15*j-15,m=0===j?74:15*j-1,o){case 0:f=["锐金","玄铁","晶竹"],E=e.slice(r,m+1);break;case 1:f=["陨铁","锡沙","秘银"],E=t.slice(r,m+1);break;case 2:f=["降龙木","锰钢","血龙木"],E=u.slice(r,m+1);break;case 3:f=["古藤","绵铁","蟒筋"],E=n.slice(r,m+1);break;case 4:f=["镜铁","磷石","黄晶"],E=l.slice(r,m+1)}return E}).then(function(){if(0!==Object.keys(I).length){let e=I[4].split(","),t=I[5].split(",");v.textContent=f[0],N.textContent=f[1],g.textContent=f[2],w["c-name"]=I[0],w["c-attack"]=Number(I[1]),w["c-weight"]=Number(I[3]),w["c-down-hardness"]=Number(e[0]),w["c-up-hardness"]=Number(e[1]),w["c-down-toughness"]=Number(t[0]),w["c-up-toughness"]=Number(t[1]),B.innerText+="当前神兵"+w["c-name"]+"\n"}}),m.onchange=function(){s.innerText=this.value,a.value=Number(q)+Number(this.value)},d.onchange=function(){c.innerText=this.value,o.value=Number(M)+Number(this.value)},i.onclick=function(){m.disabled=!0,d.disabled=!0,k=!0,b[1].childNodes[0].nodeValue="当前重量(上限"+w["c-weight"]+")",b[2].childNodes[0].nodeValue="当前硬度(上限"+w["c-up-hardness"]+")",b[3].childNodes[0].nodeValue="当前韧度(上限"+w["c-up-toughness"]+")",this.style.color="#eee"},v.onclick=function(){for(S=0;F;)k&&Number(r.value)<300&&(Number(n.value)<460&&(n.value=(Number(n.value)+Number(E[0])).toFixed(2)),Number(l.value)<w["c-weight"]&&(l.value=(Number(l.value)+Number(E[1])).toFixed(2)),!(Number(a.value)>=w["c-up-hardness"]&&Number(E[2])>0||Number(a.value)<w["c-down-hardness"]&&Number(E[2])<0)&&(a.value=(Number(a.value)+Number(E[2])).toFixed(2)),!(Number(o.value)>=w["c-up-toughness"]&&Number(E[3])>0||Number(o.value)<w["c-down-toughness"]&&Number(E[3])<0)&&(o.value=(Number(o.value)+Number(E[3])).toFixed(2)),r.value=Number(r.value)+1,S++),F--;F=Number(x.value),k&&Number(r.value)<=300&&S&&(B.innerText+="淬炼了"+S+this.textContent+"\n",console.dir(B))},N.onclick=function(){for(S=0;F;)k&&Number(r.value)<300&&(Number(n.value)<460&&(n.value=(Number(n.value)+Number(E[5])).toFixed(2)),Number(l.value)<w["c-weight"]&&(l.value=(Number(l.value)+Number(E[6])).toFixed(3)),!(Number(a.value)>=w["c-up-hardness"]&&Number(E[7])>0||Number(a.value)<w["c-down-hardness"]&&Number(E[7])<0)&&(a.value=(Number(a.value)+Number(E[7])).toFixed(2)),!(Number(o.value)>=w["c-up-toughness"]&&Number(E[8])>0||Number(o.value)<w["c-down-toughness"]&&Number(E[8])<0)&&(o.value=(Number(o.value)+Number(E[8])).toFixed(2)),r.value=Number(r.value)+1,S++),F--;F=Number(x.value),k&&Number(r.value)<=300&&S&&(B.innerText+="淬炼了"+S+this.textContent+"\n")},g.onclick=function(){for(S=0;F;)k&&Number(r.value)<300&&(Number(n.value)<460&&(n.value=(Number(n.value)+Number(E[10])).toFixed(2)),Number(l.value)<w["c-weight"]&&(l.value=(Number(l.value)+Number(E[11])).toFixed(2)),!(Number(a.value)>=w["c-up-hardness"]&&Number(E[12])>0||Number(a.value)<w["c-down-hardness"]&&Number(E[12])<0)&&(a.value=(Number(a.value)+Number(E[12])).toFixed(2)),!(Number(o.value)>=w["c-up-toughness"]&&Number(E[13])>0||Number(o.value)<w["c-down-toughness"]&&Number(E[13])<0)&&(o.value=(Number(o.value)+Number(E[13])).toFixed(2)),r.value=Number(r.value)+1,S++),F--;F=Number(x.value),k&&Number(r.value)<=300&&S&&(B.innerText+="淬炼了"+S+this.textContent+"\n")},h.onclick=function(){if(T%2==0){if((F=Number(x.value))<1||F>300-Number(r.value))return F=1,void(x.value=1);this.style.background="#000",this.textContent="锁定解除",x.disabled=!0}else F=1,this.style.background="#c8e3c8",this.textContent="倍数锁定",x.disabled=!1,x.value=1;T++},y.onclick=function(){null!==p&&(p.paused?p.play():p.pause()),C?(this.className="playBtn",C=!C):(this.className+=" active",C=!C)}},a=window.location.href,o=a.indexOf("#");switch(-1===o?null:a.slice(o+1)){case"first":n();break;case"second":l();break;default:n()}}();